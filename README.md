# Polls API
## Описание
Система API для создания и прохождения опросов. Администратор может создавать опросы и вопросы в опросах. Пользователи могут без регистрации (предоставляя id в теле запроса) проходить созданные опросы.

## Стек
Python 3.9, Django 2.2.17, Django REST framework 3.12.2

## Запуск проекта
Вариант №1 (необходимо чтобы на локальном компьютере был установлен Python3):
1. Склонируйте репозиторий на свой локальный компьютер.
2. В корневой директории проекта установите виртуальное окружение командой `python -m venv venv`.
3. Установите необходимые библиотеки командой `pip install -r requirements.txt`.
4. Выполните миграции командой `python manage.py migrate`.
5. Запустите локальный сервер командой `python manage.py runserver`.
6. Создайте учетную запись администратора командой `python manage.py createsuperuser`.
7. Приложение будет доступно по адресу http://127.0.0.1:8000/.

Вариант №2 (необходимо чтобы на локальном компьютере был установлен Docker):
1. Склонируйте репозиторий на свой локальный компьютер.
2. В корневой директории проекта создайте docker-образ командой `docker build -t polls-app .`
3. Запустите контейнер командой `docker run -it -p 8000:8000 polls-app`.
4. После запуска контейнера в новой вкладке терминала выполнить команду `docker container ls` и узнать id контейнера.
5. Перейти в контейнер выполнив команду `docker container exec -it <id контейнер> bash`.
6. Внутри контейнера выполнить команду `python manage.py migrate`.
7. Создайте учетную запись администратора командой `python manage.py createsuperuser`.
8. Приложение будет доступно в браузере по адресу http://localhost:8000/.

## Документация к API
Endpoint | Методы | Описание
------------ | ------------- | -------------
token/ | POST | Получение токена администратором. В теле запроса необходимо передать username и password
api/polls/ | GET, POST | **Только для администратора**. GET запрос для получения списка всех опросов (с пагинацией). POST запрос для создания нового опроса. Обязательны к заполнению поля title, end_date и description, start_date заполняется автоматически текущей датой.
api/polls/<poll_id>/ | GET, PUT, PATCH, DELETE | **Только для администратора**. Получить, изменить, удалить опрос по id.
api/tasks/<poll_id>/questions/ | GET, POST | **Только для администратора**. GET запрос для получения списка всех вопросов в опросе (с пагинацией). POST запрос для создания нового вопроса в опросе. Обязательны к заполнению поля text и choice_type - тип вопроса. Типы вопросов: TA - ответ текстом, OC - ответ с выбором одного варианта, MC - ответ с выбором нескольких вариантов.
api/polls/<poll_id>/questions/<question_id>/ | GET, PUT, PATCH, DELETE | **Только для администратора**. Получить, изменить, удалить вопрос в опросе по id опроса и id вопроса.
api/tasks/<poll_id>/questions/<question_id>/choices/ | GET, POST | **Только для администратора**. GET запрос для получения списка всех вариантов ответа для вопроса (с пагинацией). POST запрос для создания нового варианта ответа к вопросу. Обязательны к заполнению поля text. **Доступно только для вопросов с типом ОС и МС**.
api/polls/<poll_id>/questions/<question_id>/choices/<choice_id>/ | GET, PUT, PATCH, DELETE | **Только для администратора**. Получить, изменить, удалить вариант ответа для вопроса по id опроса, id вопроса и id ответа.
api/active-polls/ | GET | Получить список всех активных опросов (с датой окончания больше текущей), с пагинацией.
api/active-polls/<poll_id>/ | GET | Получение активного опроса по id, со списком вопросов в опросе и вариантами ответами к вопросам.
api/answer-poll/<poll_id>/questions/<question_id>/ | POST | Запрос для ответа на вопрос в опросе по id опроса и id вопроса. Обязательны к заполнению поля user_id (уникальный id пользователя), text_answer или one_choice_answer или multi_choice_answer для ответа на вопрос соответствующего типа TA, ОС или МС.
api/passed-polls/<user_id>/ | GET | Получение списка пройденных опросов по id пользователя (с пагинацией), со списком вопросов в опросе и выбранными вариантами ответов.
